<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Thirukkural</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  </head>
  <body>


  <header>
    <div class="container-fluid">
      <div class="row">
        <div class="col"></div>
        <div class="col"><h1>திருக்குறள்</h1></div>
        <div class="col"></div>
      </div>
    </div>
  </header>

  <nav class="navbar navbar-toggleable-md navbar-light navcustom">
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navContent" aria-controls="navContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="#"></a>

    <div class="collapse navbar-collapse" id="navContent">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="#"><i class="fa fa-share-alt" aria-hidden="true"></i> <span></span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/AsathalMannan/thirukkural"><i class="fa fa-github" aria-hidden="true"></i> <span></span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"><i class="fa fa-info-circle" aria-hidden="true"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"><i class="fa fa-bug" aria-hidden="true"></i></a>
        </li>
      </ul>
    </div>
  </nav>

  <section>
  <div class="container">
    <div class="row" id="index">
      <h6 class="col-12 text-center">Hover text to view Transliteration</h6>
      <!-- <div>FIRST PAAL</div> -->
    </div>
    <div class="row" id="index2">
      
    </div>
  </div>
    
  </section>

<!--   <footer>
    <div class="container">
      <div class="row">
        
      </div>
    </div>
  </footer> -->
    

    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script type='application/javascript' src='js/fastclick.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

    <script type="text/javascript">
    //attach fastclick to body
    if ('addEventListener' in document) {
      document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body);
      }, false);
    }
    </script>

    <script type="text/javascript">
      var index = document.getElementById('index');
      var index2 = document.getElementById('index2');

      var requestURL = 'db/detail.json';
      var request = new XMLHttpRequest();
      request.open('GET', requestURL);
      request.responseType = 'json';
      request.send();

      request.onload = function() {
        var details = request.response;
        populateHeader(details);
      }

      function populateHeader(jsonObj) {
        var paal = jsonObj[0].section.detail;
        var z=0;
        for (var h = 0; h < paal.length; h++) {

        var paal_head = document.createElement('a');
            paal_head.setAttribute("class", "text-center col-sm-12 col-md-4 col-lg-4 col-xl-4 paal-head");
            paal_head.setAttribute("data-toggle", "collapse");
            paal_head.setAttribute("href", "#id"+h);
            paal_head.setAttribute("aria-expanded", "false");
            paal_head.setAttribute("aria-controls", "id"+h);
        paal_head.appendChild(document.createTextNode(jsonObj[0].section.detail[h].name));

        // var extra = document.createElement('div');
        //     extra.setAttribute("class", "col-auto");

        var collap = document.createElement('div');
            collap.setAttribute("class", "collapse show col-sm-12 col-md-4 col-lg-4 col-xl-4 mb-4");
            collap.setAttribute("id", "id"+h);

        var list = document.createElement('div');
            list.setAttribute("class", "list-group col-sm-12 ml-2");
            // list.setAttribute("id", "id"+h);
        
        var arathu = jsonObj[0].section.detail[h].chapterGroup.detail;
        

        for (var i = 0; i < arathu.length; i++) {
          var athigaram = jsonObj[0].section.detail[h].chapterGroup.detail[i].chapters.detail;
          for (var j = 0; j < athigaram.length; j++) {
        z++;

        var stk = jsonObj[0].section.detail[h].chapterGroup.detail[i].chapters.detail[j].start;
        var enk = jsonObj[0].section.detail[h].chapterGroup.detail[i].chapters.detail[j].end;

        var dummy = "postvar('"+h+"','"+i+"','"+j+"','"+stk+"','"+enk+"');";
        var item = document.createElement('a');
            item.setAttribute("class", "list-group-item list-group-item-action flex-column align-items-start");
            item.setAttribute("onClick", dummy);
            // item.setAttribute("href", "javascript:void(0)");

        var column = document.createElement('div');
            column.setAttribute("class", "d-flex w-100 justify-content-between");

        var column_head = document.createElement('h6');
            column_head.setAttribute("class", "mb-1");
            column_head.setAttribute("data-toggle", "tooltip");
            column_head.setAttribute("data-placement", "top");
            column_head.setAttribute("title", jsonObj[0].section.detail[h].chapterGroup.detail[i].chapters.detail[j].transliteration);

        var iyal = document.createElement('small');
            iyal.setAttribute("data-toggle", "tooltip");
            iyal.setAttribute("data-placement", "top");
            iyal.setAttribute("title", jsonObj[0].section.detail[h].chapterGroup.detail[i].transliteration + "<br>" + jsonObj[0].section.detail[h].chapterGroup.detail[i].translation);

        var trans_head = document.createElement('small');
            trans_head.setAttribute("class", "mb-1");

        var trans_iyal = document.createElement('small');
          
        // Set its contents:
        column_head.appendChild(document.createTextNode(z + ". " +jsonObj[0].section.detail[h].chapterGroup.detail[i].chapters.detail[j].name));
        iyal.appendChild(document.createTextNode(jsonObj[0].section.detail[h].chapterGroup.detail[i].name));
        trans_head.appendChild(document.createTextNode(jsonObj[0].section.detail[h].chapterGroup.detail[i].chapters.detail[j].translation));
        trans_iyal.appendChild(document.createTextNode(jsonObj[0].section.detail[h].chapterGroup.detail[i].translation));

        // Add it to the list:
        column.appendChild(column_head);
        column.appendChild(iyal);
        item.appendChild(column);
        item.appendChild(trans_head);
        // list.appendChild(paal_head);
        list.appendChild(item);
        collap.appendChild(list);
        index.appendChild(paal_head);
        // extra.appendChild(collap);
        index2.appendChild(collap);
          }
        }
         // return list;
       }
      }
    </script>
    <script type="text/javascript">
      function postvar(v1,v2,v3,v4,v5){
        url = 'athigaram.html?h=' + encodeURIComponent(v1) + '&i=' + encodeURIComponent(v2) + '&j=' + encodeURIComponent(v3) + '&stk=' + encodeURIComponent(v4) + '&enk=' + encodeURIComponent(v5);

    document.location.href = url;
      }
      
    </script>
    <script type="text/javascript">
      $(function(){
        $('[data-toggle="tooltip"]').tooltip({

            html: true,
            animation: false //workaround. bug will fixed in next bootstrap release

        });
      });
    </script>
  </body>
</html>